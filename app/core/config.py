from pydantic_settings import BaseSettings, SettingsConfigDict
from app.core.logger_config import logger


class Settings(BaseSettings):
    model_config = SettingsConfigDict(
        env_file=".env", env_file_encoding="utf-8", case_sensitive=False
    )

    GEMINI_API_KEY: str
    MODEL_NAME: str = "gemini-2.5-flash"
    BASE_URL: str = "https://fanfan.softium-deti.ru:820"

    PROMPT: str = """Сформируй короткий связный отчёт о работе ребёнка на занятии для родителей.

Формат:

* 1 абзац, 1–2 предложения. Без списков, без заголовков, без эмодзи.
* 180–360 знаков (примерно 25–55 слов).

Стиль и смысл:

* Простой, нейтральный, живой.
* Фокус на процессе: как ребёнок действовал, рассуждал, что пробовал/настраивал/сравнивал/исправлял, как проверял гипотезы.
* Можно 1 раз в конце добавить «молодец», если уместно.

Запреты (строго):

* Имя: краткая форма без уменьшительно-ласкательных суффиксов.
* Запрещены слова с корнем «уч» (учил, учится, обучение, научился и т.п.).
* Запрещены временные маркеры: «сегодня», «сначала», «затем», «потом», «в итоге», «после этого», «в конце» и т.п.
* Не используй восторженные клише: «прекрасно», «замечательно», «супер», «круто», «великолепно», «очень хорошо», «успешно».

  * не пиши «Задание», не вставляй названия в кавычках,
  * не пересказывай текст в скобках.
* НЕЛЬЗЯ писать «выполнил(а) X заданий» (число используй только как слабый индикатор темпа/нагрузки, без цифры в тексте).

Как использовать список заданий:

* Прочитай задания и выведи из них 2–4 обобщённых навыка/действия (например: работа с условиями/циклами/координатами/событиями; настройка сцен/персонажей; отладка; поиск ошибки; сравнение вариантов; аккуратность в шагах; самостоятельность).
* Затем напиши абзац только про процесс, не используя исходные формулировки заданий.

Комментарий преподавателя:

* Если комментарий есть и он не равен «Нет комментариев.» — обязательно учти его одной короткой мыслью, без цитат и без «по словам преподавателя».
* Если комментария нет — не упоминай его.

Если в заданиях: «Нет описаний выполненных заданий.»

* Пиши обобщённо про процесс, опираясь на платформу/направление (если понятно) и комментарий преподавателя.

ВХОД:
Имя ребёнка: {name}
Количество выполненных заданий: {progress}
Выполненные задания:
{tasks_block}
Комментарий преподавателя:
{comments}

Выведи только готовый абзац отчёта.

"""


settings = Settings()
logger.info("⚙️ Settings loaded successfully")
